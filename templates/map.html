<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
        <script src="https://kit.fontawesome.com/c30dadd52a.js" crossorigin="anonymous"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.0/flowbite.min.css"  rel="stylesheet" />
    
        <!-- FONTS -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700&display=swap"
            rel="stylesheet">
            <link rel="stylesheet" href="static\css\dashboard.css">
		<script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
        
    </head>
    <body class="flex flex-col">
<header class="">
            <nav class="fixed bg-white shadow flex justify-between items-center w-[100%]  mx-auto">
                <div>
                <a href="#">  <img style="width:3rem" src="https://i.postimg.cc/rwCkh2vz/Logo-White.png" alt="..."></a>
                </div>
                <div class="nav-links duration-500 md:static absolute bg-white md:min-h-fit min-h-[60vh] left-0 top-[-100%] md:w-auto  w-full flex items-center px-5">
                <ul class="flex md:flex-row flex-col md:items-center md:gap-[4vw] gap-8">
                <li>
                <a class="" href="#">
                                <div class="text-xl bg-red-800 text-white w-10 h-10 flex justify-center items-center rounded-lg mx-auto hover:bg-blue-800">
                                    <i class="fa-solid fa-house"></i>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="" href="/events">
                                <div class="text-xl bg-white text-gray-500 w-10 h-10 flex justify-center items-center rounded-lg mx-auto hover:bg-blue-800 hover:text-white">
                                    <i class="fa-regular fa-calendar-days"></i>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="" href="/government_profiles">
                                <div class="text-xl bg-white text-gray-500 w-10 h-10 flex justify-center items-center rounded-lg mx-auto hover:bg-blue-800 hover:text-white">
                                    <i class="fa fa-building-o"></i>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="" href="#">
                                <div class="text-xl bg-white text-gray-500 w-10 h-10 flex justify-center items-center rounded-lg mx-auto hover:bg-blue-800 hover:text-white">
                                    <i class="fa-solid fa-map-location-dot"></i>                            </div>
                            </a>
                        </li>
                        <li>
                            <form class="flex items-center">
                                <label for="simple-search" class="sr-only">Search</label>
                                <div class="relative w-full">
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                    <svg aria-hidden="true" class="w-5 h-5 text-[#858EAD]" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <input type="text" id="simple-search" class="block w-full p-2.5 pl-20 text-sm text-[#858EAD] rounded-lg bg-[#F4F6F8] border focus:ring-primary-100 focus:border-primary-100" placeholder="Type here to search..." required="">
                                </div>
                            </form>
        
                        </li>
                    </ul>
                </div>
                <div class="flex items-center gap-6">
                    {% comment %} <button class="bg-[#043172] text-white px-5 py-2 rounded-full hover:bg-[#10223B]">Sign in</button> {% endcomment %}
                    
                    <button id="notificationButton" type="button" data-dropdown-toggle="notification-dropdown" class="p-2 mr-1 text-gray-500 rounded-lg hover:text-gray-900 hover:bg-blue-800 hover:text-white dark:text-gray-400 dark:hover:text-white dark:hover:bg-blue-800 focus:ring-4 focus:ring-blue-800 dark:focus:ring-blue-800">
                        <span class="sr-only">View notifications</span>
                        <!-- Bell icon -->
                        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 14 20"><path d="M12.133 10.632v-1.8A5.406 5.406 0 0 0 7.979 3.57.946.946 0 0 0 8 3.464V1.1a1 1 0 0 0-2 0v2.364a.946.946 0 0 0 .021.106 5.406 5.406 0 0 0-4.154 5.262v1.8C1.867 13.018 0 13.614 0 14.807 0 15.4 0 16 .538 16h12.924C14 16 14 15.4 14 14.807c0-1.193-1.867-1.789-1.867-4.175ZM3.823 17a3.453 3.453 0 0 0 6.354 0H3.823Z"/></svg>
                    </button>
        
                    {% comment %} Notifications {% endcomment %}
                     <!-- Dropdown menu -->
                    {% comment %} Profile Secion {% endcomment %}
                    <div id="profileContainer" class="flex items-center gap-3 cursor-pointer mx-2 rounded-full focus:ring-2 hover:ring-2 hover:ring-gray-600 focus:ring-gray-800 ">
                        <img class="w-10 h-10 rounded-full" src="https://placekitten.com/40/40" alt="Profile Picture">
                    </div>
                    <div id="profileDropdown"
                        class="hidden origin-top-right absolute right-2 top-14 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                        <div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="profileContainer">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                                role="menuitem">Profile Settings</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
                                role="menuitem">Logout</a>
                        </div>
                    </div>
                    {% comment %} Hamburger {% endcomment %}
                    <ion-icon onclick="onToggleMenu(this)" name="menu" class="text-3xl cursor-pointer md:hidden"></ion-icon>
                </div>
        </header>

{% comment %} Map {% endcomment %}
<section id="mapContainer" class="blog bg-blue-950 min-h-screen mt-12 items-center justify-center" style="padding-top: 30px;">
    <h1 class="text-4xl font-bold text-white ml-10">Locate Government Offices</h1>
<div id="map" class="bg-blue-50 mt-4 items-center justify-center mx-40 rounded-lg" style="height: 70vh; width:150vh"></div>
</section>
<script>
{% comment %} Getting the User's Live Location Coordinates {% endcomment %}
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError);
    } else {
        alert("Geolocation is not supported by this browser.");
    }
}

function showPosition(position) {
    var UserLat = position.coords.latitude;
    var UserLong = position.coords.longitude;
    {% comment %} alert("You are here: " UserLat +", "+ UserLong); {% endcomment %}
console.log(UserLat+','+UserLong);

map.setView([UserLat, UserLong], 15);

    var userMarker = L.marker([UserLat, UserLong]).addTo(map);
    var userPopupContent = "<b>You are Here!</b> ";
    userMarker.bindPopup(userPopupContent).openPopup();

    // You can now use the latitude and longitude as needed, for example, send them to your server.
}

function showError(error) {
    switch (error.code) {
        case error.PERMISSION_DENIED:
            alert("User denied the request for Geolocation.");
            break;
        case error.POSITION_UNAVAILABLE:
            alert("Location information is unavailable.");
            break;
        case error.TIMEOUT:
            alert("The request to get user location timed out.");
            break;
        case error.UNKNOWN_ERROR:
            alert("An unknown error occurred.");
            break;
    }
}

// Call getLocation as soon as the page is loaded
window.onload = getLocation;

    var map = L.map('map').setView([27.706130300000016, 85.3300594693138], 13);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);

var leafletIcon=L.icon({
    iconUrl: 'https://i.postimg.cc/tJPrB0xZ/office-Marker.png',
    iconSize: [40,60],
    iconAnchor: [22,94],
    popupAnchor:[12,-90]
})

{% for profile in profiles %}
        // Split the address string into latitude and longitude
        var coordinates = "{{ profile.address }}".split(',').map(parseFloat);
        var marker{{ profile.id }} = L.marker(coordinates, {icon:leafletIcon}).addTo(map);
        var popupContent{{ profile.id }} = "<b>{{ profile.name }}</b><br><a href='/government_profile/{{ profile.id }}'>Details</a>";
        marker{{ profile.id }}.bindPopup(popupContent{{ profile.id }}).openPopup();
    {% endfor %}

</script>
{% comment %} Map Ends {% endcomment %}
        
   

<script src="static/javascript/dashboard.js"></script>
    
    </body>
</html>